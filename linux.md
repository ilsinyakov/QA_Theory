# Linux

## Пользователи, группы и права доступа

### Учетные записи ОС

1. **Стандартные учетные записи**: создаются для обычных пользователей.  
> Стандартные учетные записи: могут входить в систему, выполнять команды и читать некоторые файлы или директории. Они не могут изменять любую часть ОС и "общесистемных" приложений. По умолчанию они могут изменять данные только в своих домашних директориях и /tmp.
2. **Административная учетная запись**: ее имя - root, и она является единственным администратором ОС (у вас не может быть двух root). Учетная запись root используется для прямого входа в систему очень редко; вместо этого администраторы временно повышают свои привилегии до root для обслуживания системы и других важных операций.  
> Административная (root) учетная запись: может входить в систему и делать все с ОС и пользователями без каких-либо ограничений (в отличие от Windows, где учетная запись администратора не настолько мощная, как учетная запись "Локальная система").
3. **Служебные учетные записи**: создаются для служб и других специальных целей; не должны использоваться пользователями. Например, для запуска бэкэнд-приложения (или приложения сервера базы данных) должна использоваться отдельная учетная запись.  Это минимизирует возможные последствия в случае сбоя или взлома приложения.  
> Служебные учетные записи: не могут входить в систему. ОС, службы и приложения (запускаемые root) используют их для специальных целей, например, для запуска определенных программ, служб и т.д.

**Основные настройки учетной записи: /etc/passwd**

`/etc/passwd` - это основной конфигурационный файл для учетных записей пользователей

`egrep ${USER} /etc/passwd` - информация о своей учетной записи.

Формат файла. В качестве разделителя полей используется ':', таким образом:  
`feodor:x:1000:100:User Description Here:/home/feodor:/bin/bash`  
* feodor - имя пользователя, должно быть уникальным
* x - поле не используется, поэтому мы имеем здесь 'x' как заглушку
* 1000 - идентификатор пользователя, называемый "UID", должен быть уникальным. Пользователи в основном имеют UID >= 1000. Пользователь root всегда имеет UID 0. Учетные записи служб имеют UID от 1 до (в основном) 999. Никто, кроме root, не должен иметь UID 0.
* 100 - идентификатор основной группы. Каждый пользователь должен быть членом хотя бы одной группы (не существует пользователей "без групп"). Если пользователей нужно включить в большее количество групп, это настраивается в /etc/group (см. следующий раздел).
* User Description Here - это поле может быть пустым или содержать что угодно, кроме ':'. Оно не играет никакой роли в ОС и механизмах входа в систему.
* /home/feodor - домашний каталог пользователя; вы автоматически помещаетесь сюда после успешного входа в систему
* /bin/bash - программа, выполняемая при успешном входе в систему. Сервисные учетные записи не предназначены для входа в систему и работы в командной строке, поэтому у них здесь указаны специальные "псевдо" программы, такие как /bin/false или /sbin/nologin

Хеши паролей хранятся в файле `/etc/shadow`

### Группы ОС

Понятие групп в UNIX:

* Группы включают несколько (0 или более) пользователей для упрощения управления пользователями и разделения привилегий
* Каждый пользователь должен быть членом как минимум одной группы - она задается в `/etc/passwd`, такая группа называется "основной" для конкретного пользователя
* Каждый пользователь может быть включен в 0 или более дополнительных групп, называемых "вторичными группами" (secondary groups). Членство во вторичных группах настраивается в файле `/etc/group`.
* Нет никакой разницы (в плане привилегий) между членством в первичной и вторичной группах.

`egrep ${USER} /etc/group`  
```
wheel:x:10:feodor
users:x:100:feodor,[ ... a lot of users here ... ]
feodor:x:1000:
qa:x:1001:feodor,user1,user2
```  
* Название группы
* Всегда 'x'
* Идентификатор группы, называемый "GID", должен быть уникальным
* Список членов группы, разделенный запятыми, может быть пустым

Членство в группе зависит от `/etc/passwd` и `/etc/group` - например, группа "qa" имеет только 3 явно включенных члена, но может быть много других членов в группах "qa", определенных в `/etc/passwd` путем указания 1001 в качестве основного GID. 

### Команды для работы с пользователями и группами

`whoami` - получить имя текущего пользователя

`id` - получить расширенную информацию о текущем пользователя и его членстве в группах  
`id -u` - только UID  
`id -G` - только GID  
`id -Gn` - имена групп

`groups` - имена групп

### Повышение привилегий




