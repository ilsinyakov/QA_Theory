# CI / CD

## Основные понятия

**CI/CD** — это способ разработки, в котором тестирование и развёртывание кода происходит автоматически. Основная цель — ускорить выпуск обновлений и повысить качество ПО за счёт регулярного тестирования.

**Continuous Integration (CI, непрерывная интеграция)** — автоматическая интеграция кода в репозиторий проекта. Цель CI — упростить объединение кода от разных разработчиков и быстро выявлять ошибки. Когда программист отправляет код в репозиторий, система запускает тесты. Если в проекте найдутся ошибки, то разработчику придётся забрать код на доработку.

**Continuous Delivery (CD, непрерывная доставка)** — это автоматическая подготовка кода к выпуску. Представьте команду, которая разрабатывает веб-приложение. При каждом изменении кода CD-система автоматически тестирует работоспособность, собирает нужные файлы и разворачивает приложение в тестовой среде. Когда менеджер проекта принимает решение о выпуске новой версии, он активирует публикацию одним нажатием — и подготовленный код разворачивается на рабочем сервере.

**Continuous Deployment (CD, непрерывное развёртывание)** — автоматическая доставка кода пользователям без участия разработчиков. Каждое изменение в коде, прошедшее тесты, сразу уходит на основной сервер.

![CI/CD](https://github.com/ilsinyakov/QA_Theory/blob/main/Pictures/cicd.png?raw=true)

Непрерывная интеграция в CI/CD — ***обязательный*** этап, а доставка и развёртывание — ***опциональные***. Доставка подходит командам, которые хотят контролировать, когда и какие обновления будут получать пользователи, а развёртывание — тем, кому важно, чтобы изменения моментально появлялись на продакшене.

## Функции CI / CD

Основные функции CI:

* **Статический анализ**. Линтеры для разных языков программирования анализируют код, проверяют синтаксис, стиль и ищут ошибки. Это позволяет ещё до запуска программы найти проблемы с производительностью и отправить код на доработку.
* **Тестирование кода**. На этом этапе система проверяет, не ломает ли обновление уже те функции, которые есть в программе, и насколько новый код работоспособен. Если автоматические тесты выявляют ошибку, то обновление возвращают программистам на доработку.
* **Проверка качества**. В каждой команде используют свои архитектурные решения, стандарты безопасности и требования к оформлению кода. На этом этапе проверяют, соблюдаются ли все эти правила.

Основные функции CD:

* **Сборка кода**. Проект обычно представляет собой набор файлов с кодом, которые надо связать между собой, создать исполняемый файл, упаковать всё в Docker-контейнер или архив.
* **Публикация релиза**. Собранный проект надо доставить пользователям в виде обновления или загрузить на сервер, откуда его можно будет скачать.
* **Управление сертификатами**. Разработчики используют множество сертификатов шифрования, которые обеспечивают безопасное взаимодействие приложения с сервером. Процесс обновления сертификатов автоматизируют, чтобы не забывать делать это вручную.

## Как работает CI/CD

## Jenkins

### Установка плагинов

* **Git Plugin**. Позволяет Jenkins’у работать с Git-репозиториями.
* **GitHub Plugin / GitHub Integration Plugin**. Обеспечивает интеграцию с GitHub и позволяет принимать уведомления от GitHub.

### Добавление SSH-ключей в Credentials

* Настройка_Jenkins / Security / Credentials / System / Global_credentials
* Жмем *Add Credentials*
* В поле *Kind* выберите *SSH Username with private key*
* Заполняем поля:
  * *Scope*: обычно оставляют *Global*
  * *Username*: имя пользователя на вашем удалённом сервере
  * *Private Key*: если у вас уже готов открытый/закрытый ключ, выберите Enter directly и вставьте содержимое вашего приватного ключа
  * *ID* (необязательно): по умолчанию Jenkins присвоит автоматически UUID, но вы можете явно прописать, например, REMOTE_SSH_CRED
  * *Description* - описание
* *ОК*

### Создание пайплайна

* Создаем `Item` типа `Pipeline`
* В настройках в Triggers ставим галочку: *GitHub hook trigger for GITScm polling* - чтобы Jenkins слушал события на эндпоинте github-webhook

### Настройка WebHook в репозитории

* В репозитории GitHub → Settings → Webhooks → Add webhook
* *Payload URL*:  
`https://<JENKINS_URL>/github-webhook/`
* *Content type*:  
`application/json`
* *Which events*: выберите Just the push event
* *Add webhook*
